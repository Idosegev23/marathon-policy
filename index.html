<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>מדיניות ביטולים ותקנון - מרתון GEN-Z</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rubik:ital,wght@0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
</head>
<body>
    <header class="fixed top-0 left-0 right-0 z-50 bg-white/95 backdrop-blur-sm shadow-soft">
        <nav class="container-center py-4">
            <div class="flex items-center justify-center">
                <div class="flex items-center">
                    <div class="w-12 h-12 bg-gradient-to-br from-pastel-coral to-pastel-pink rounded-full flex items-center justify-center shadow-soft mr-3">
                        <span class="text-white font-black text-xl">E</span>
                    </div>
                    <div>
                        <h1 class="font-black text-xl text-text-black">מרתון GEN-Z</h1>
                        <p class="text-sm text-text-black/70">מדיניות ביטולים ותקנון</p>
                    </div>
                </div>
            </div>
        </nav>
    </header>

    <main class="pt-28 bg-gradient-to-br from-pastel-yellow/20 via-white to-pastel-blue/25 min-h-screen">
        <section class="py-20">
            <div class="container-center">
                <div class="text-center mb-16">
                    <h2 class="text-4xl md:text-6xl font-black mb-8 text-pastel-coral">מדיניות ביטולים ותקנון</h2>
                    <p class="text-xl text-darker mb-8">אנא קרא/י בעיון את המדיניות הבאה לפני הרשמה למרתון</p>
                </div>

                <div class="max-w-4xl mx-auto">
                    <!-- מדיניות ביטולים -->
                    <div class="bg-white/80 backdrop-blur-sm rounded-5xl p-8 shadow-soft mb-16 border-2 border-pastel-coral/20">
                        <div class="flex items-center mb-6">
                            <div class="w-12 h-12 bg-pastel-coral/20 rounded-full flex items-center justify-center mr-4">
                                <span class="text-2xl">📌</span>
                            </div>
                            <h3 class="text-2xl font-black text-pastel-coral">מדיניות ביטולים והרשמה</h3>
                        </div>
                        
                        <div class="space-y-4 text-lg text-darker leading-relaxed">
                            <p>• ההרשמה היא מראש עבור כל ששת המפגשים.</p>
                            <p>• <strong>ביטול עד 7 ימים לפני תחילת המפגשים – יינתן החזר מלא.</strong></p>
                            <p>• <strong>ביטול פחות מ-7 ימים לפני תחילת המרתון – יינתן החזר של 50%.</strong></p>
                            <p>• <strong>לאחר תחילת המפגשים – לא יתאפשר החזר כספי.</strong></p>
                            <p>• היעדרות ממפגש בודד אינה מזכה בהחזר, אך יועבר סיכום אישי ודפי תרגול.</p>
                            <p>• במידה ומשתתף נעדר ממפגש וירצה להשלים בקבוצה אחרת – הדבר יתאפשר רק במידה ויתפנה מקום, ואין בכך התחייבות.</p>
                            <p>• הרשמה מותנית בגיבוש קבוצה של 5 משתתפים. אם לא תתגבש קבוצה – יינתן החזר כספי מלא לנרשמים.</p>
                        </div>
                    </div>

                    <!-- תקנון -->
                    <div class="bg-white/80 backdrop-blur-sm rounded-5xl p-8 shadow-soft mb-16 border-2 border-pastel-blue/20" id="terms-section">
                        <div class="flex items-center mb-6">
                            <div class="w-12 h-12 bg-pastel-blue/20 rounded-full flex items-center justify-center mr-4">
                                <span class="text-2xl">📋</span>
                            </div>
                            <h3 class="text-2xl font-black text-pastel-blue">תקנון</h3>
                        </div>
                        
                        <div class="space-y-8">
                            <div class="bg-pastel-yellow/20 rounded-3xl p-6">
                                <h4 class="text-xl font-bold text-darker mb-4">1. זכויות יוצרים על תכנים</h4>
                                <p class="text-lg text-darker">כל חומרי הקורס ניתנים לשימוש אישי בלבד של המשתתפים, ואין להעבירם, לשכפל או לפרסם ללא אישור מראש.</p>
                            </div>

                            <div class="bg-pastel-mint/20 rounded-3xl p-6">
                                <h4 class="text-xl font-bold text-darker mb-4">2. שמירה על פרטיות המשתתפים</h4>
                                <p class="text-lg text-darker">כל פרט אישי שנמסר בטופס או בשאלון נשמר לצרכי הקורס בלבד ולא יועבר לגורם חיצוני.</p>
                            </div>

                            <div class="bg-pastel-pink/20 rounded-3xl p-6">
                                <h4 class="text-xl font-bold text-darker mb-4">3. אחריות על תוצאה</h4>
                                <p class="text-lg text-darker">המפגשים נועדו לחזק את הביטחון והיכולות של הילד באנגלית. ההשתתפות אינה מבטיחה שיפור ציונים או הישגים מסוימים - אך נעשית מתוך מטרה מוצהרת לייצר חוויית למידה משמעותית ומקדמת.</p>
                            </div>

                            <div class="bg-pastel-coral/20 rounded-3xl p-6">
                                <h4 class="text-xl font-bold text-darker mb-4">4. שמירה על התנהלות תקינה בקבוצה</h4>
                                <p class="text-lg text-darker mb-4">במידה ומשתתף מפר את רוח הקבוצה:</p>
                                <p class="text-lg text-darker">נשמרת הזכות להפסיק השתתפות של ילד/ה במידה ויש פגיעה מתמשכת בהתנהלות הקבוצה או בחוויית הלמידה של אחרים – לאחר שיח והתרעה מול ההורים. במקרה כזה ייבחן החזר יחסי לפי שיקול דעת.</p>
                            </div>

                            <div class="bg-pastel-blue/20 rounded-3xl p-6">
                                <h4 class="text-xl font-bold text-darker mb-4">5. שימוש בתמונות / תיעוד</h4>
                                <p class="text-lg text-darker">תיעוד מצולם של המפגשים ייעשה רק באישור ההורים מראש, וישמש למטרות שיתוף מוגבלות (כגון תיעוד אישי או המלצה), ולא יפורסם באופן ציבורי ללא הסכמה.</p>
                            </div>
                        </div>
                    </div>

                    <!-- תחתית עם אישור ולינקים -->
                    <div class="bg-gradient-to-br from-pastel-mint to-pastel-blue text-white rounded-5xl p-8 shadow-soft-lg">
                        <div class="text-center mb-8">
                            <h3 class="text-3xl font-black mb-4">אישור קריאה ומעבר לתשלום</h3>
                            <p class="text-lg mb-8">בבקשה אשרו כי קראתם ומסכימים למדיניות לפני המעבר לתשלום</p>
                            
                            <div class="flex items-center justify-center mb-8 px-4">
                                <input type="checkbox" id="readConfirmation" class="mr-3 w-5 h-5 text-pastel-coral flex-shrink-0">
                                <label for="readConfirmation" class="text-lg font-semibold cursor-pointer leading-relaxed">
                                    אני מאשר/ת שקראתי ומסכים/ה לתנאים המפורטים למעלה
                                </label>
                            </div>
                        </div>

                        <div class="text-center mb-8">
                            <button id="proceedToPayment" 
                                    class="payment-proceed-btn disabled bg-white/30 text-white/50 py-4 px-8 rounded-3xl text-xl font-bold mb-4 inline-block w-full max-w-sm mx-auto cursor-not-allowed">
                                להמשך תשלום
                            </button>
                        </div>

                        <div class="text-center">
                            <p class="text-lg mb-4">יש לכם שאלות נוספות?</p>
                            <a href="https://wa.me/972545886779" 
               target="_blank" 
               class="inline-block bg-green-500 hover:bg-green-600 text-white py-4 px-8 rounded-3xl text-xl font-bold transition-colors duration-300 w-full max-w-sm mx-auto">
                <span class="inline-block mr-2">📱</span>
                צרו קשר בוואטסאפ
            </a>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- פופאפ טופס תשלום -->
    <div id="paymentModal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="text-2xl font-black text-darker mb-2">פרטים להמשך תשלום</h3>
                <p class="text-lg text-darker/70 mb-6">אנא מלאו את הפרטים הבאים להמשך התהליך</p>
                <button id="closeModal" class="modal-close">&times;</button>
            </div>
            
            <form id="paymentForm" class="modal-body">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="firstName">
                            <span class="form-icon">👤</span>
                            שם פרטי
                        </label>
                        <input type="text" id="firstName" name="firstName" required placeholder="הכניסו את השם הפרטי">
                    </div>
                    
                    <div class="form-group">
                        <label for="lastName">
                            <span class="form-icon">👤</span>
                            שם משפחה
                        </label>
                        <input type="text" id="lastName" name="lastName" required placeholder="הכניסו את שם המשפחה">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="phone">
                        <span class="form-icon">📱</span>
                        נייד
                    </label>
                    <input type="tel" id="phone" name="phone" required placeholder="050-1234567">
                </div>
                
                <div class="form-group">
                    <label for="email">
                        <span class="form-icon">📧</span>
                        כתובת מייל
                    </label>
                    <input type="email" id="email" name="email" required placeholder="example@email.com">
                </div>
                
                <div class="form-group">
                    <label for="group">
                        <span class="form-icon">👥</span>
                        קבוצה
                    </label>
                    <select id="group" name="group" required>
                        <option value="">בחר/י קבוצה</option>
                        <option value="grade7">עולים לכיתה ז׳</option>
                        <option value="grade6">עולים לכיתה ו׳</option>
                    </select>
                </div>
                
                <div class="form-note">
                    <div class="note-icon">💳</div>
                    <p>הפרטים הללו יופיעו בקבלה שתישלח אליכם</p>
                </div>
                
                <div class="checkboxes-container">
                    <div class="checkbox-group">
                        <input type="checkbox" id="policyCheck" name="policyCheck" required>
                        <label for="policyCheck">
                            אני מאשר/ת שקראתי ומסכים/ה ל
                            <a href="#" id="viewPolicy" class="policy-link">מדיניות ביטולים</a>
                        </label>
                    </div>
                    
                    <div class="checkbox-group">
                        <input type="checkbox" id="termsCheck" name="termsCheck" required>
                        <label for="termsCheck">
                            אני מאשר/ת שקראתי ומסכים/ה ל
                            <a href="#" id="viewTerms" class="policy-link">תקנון</a>
                        </label>
                    </div>
                </div>
                
                <div class="payment-section">
                    <button type="button" id="paymentLink" class="payment-final-btn disabled">
                        מעבר לתשלום
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // זיהוי מכשיר
        function isMobileDevice() {
            return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || 
                   window.innerWidth <= 768;
        }

        // הפעלה/השבתה של כפתור המשך תשלום
        function toggleProceedButton() {
            const checkbox = document.getElementById('readConfirmation');
            const proceedBtn = document.getElementById('proceedToPayment');
            
            if (checkbox.checked) {
                proceedBtn.classList.remove('disabled');
                proceedBtn.classList.add('enabled');
                proceedBtn.style.backgroundColor = '#4CAF50';
                proceedBtn.style.color = 'white';
                proceedBtn.style.cursor = 'pointer';
                proceedBtn.disabled = false;
            } else {
                proceedBtn.classList.add('disabled');
                proceedBtn.classList.remove('enabled');
                proceedBtn.style.backgroundColor = 'rgba(255,255,255,0.3)';
                proceedBtn.style.color = 'rgba(255,255,255,0.5)';
                proceedBtn.style.cursor = 'not-allowed';
                proceedBtn.disabled = true;
            }
        }

        // פתיחת המודל
        function openPaymentModal() {
            const modal = document.getElementById('paymentModal');
            modal.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        // סגירת המודל
        function closePaymentModal() {
            const modal = document.getElementById('paymentModal');
            modal.classList.add('hidden');
            document.body.style.overflow = '';
        }

        // בדיקת תקינות הטופס והפעלת כפתור התשלום
        function validateForm() {
            const firstName = document.getElementById('firstName').value.trim();
            const lastName = document.getElementById('lastName').value.trim();
            const phone = document.getElementById('phone').value.trim();
            const email = document.getElementById('email').value.trim();
            const group = document.getElementById('group').value;
            const policyCheck = document.getElementById('policyCheck').checked;
            const termsCheck = document.getElementById('termsCheck').checked;
            const paymentBtn = document.getElementById('paymentLink');
            
            // וולידציה מתקדמת
            const isValidEmail = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
            const isValidPhone = /^05\d{8}$/.test(phone.replace(/\D/g, ''));
            const isValidName = firstName.length >= 2 && lastName.length >= 2;
            
            const isFormValid = isValidName && isValidPhone && isValidEmail && group && policyCheck && termsCheck;
            
            // וולידציה ויזואלית לכל שדה
            updateFieldValidation('firstName', firstName.length >= 2);
            updateFieldValidation('lastName', lastName.length >= 2);
            updateFieldValidation('phone', isValidPhone);
            updateFieldValidation('email', isValidEmail);
            updateFieldValidation('group', group !== '');
            
            if (isFormValid) {
                paymentBtn.classList.remove('disabled');
                paymentBtn.disabled = false;
                paymentBtn.style.backgroundColor = '#4CAF50';
                paymentBtn.style.color = 'white';
                paymentBtn.style.cursor = 'pointer';
            } else {
                paymentBtn.classList.add('disabled');
                paymentBtn.disabled = true;
                paymentBtn.style.backgroundColor = '#ccc';
                paymentBtn.style.color = '#666';
                paymentBtn.style.cursor = 'not-allowed';
            }
        }

        // עדכון סטיילינג לפי תקינות השדה
        function updateFieldValidation(fieldId, isValid) {
            const field = document.getElementById(fieldId);
            const value = field.value.trim();
            
            if (value === '') {
                // שדה ריק - לא נראה שגיאה
                field.style.borderColor = '#E2E8F0';
                field.style.background = 'linear-gradient(135deg, #ffffff, #fafafa)';
            } else if (isValid) {
                // שדה תקין
                field.style.borderColor = '#22c55e';
                field.style.background = 'linear-gradient(135deg, #f0fdf4, #ffffff)';
            } else {
                // שדה לא תקין
                field.style.borderColor = '#ef4444';
                field.style.background = 'linear-gradient(135deg, #fef2f2, #ffffff)';
            }
        }

        // שליחת וובהוק
        async function sendWebhook(formData) {
            const webhookData = {
                firstName: formData.firstName,
                lastName: formData.lastName,
                phone: formData.phone,
                email: formData.email,
                group: formData.group,
                policyAgreed: formData.policyCheck,
                termsAgreed: formData.termsCheck,
                timestamp: new Date().toISOString(),
                source: 'policy-site'
            };

            try {
                await fetch('https://hook.eu2.make.com/vty0bsab92etx8ctno6axd5pb2i89niv', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(webhookData)
                });
            } catch (error) {
                console.error('שגיאה בשליחת וובהוק:', error);
            }
        }

        // מעבר לתשלום
        async function proceedToPayment() {
            const formData = {
                firstName: document.getElementById('firstName').value.trim(),
                lastName: document.getElementById('lastName').value.trim(),
                phone: document.getElementById('phone').value.trim(),
                email: document.getElementById('email').value.trim(),
                group: document.getElementById('group').value,
                policyCheck: document.getElementById('policyCheck').checked,
                termsCheck: document.getElementById('termsCheck').checked
            };

            // שליחת וובהוק
            await sendWebhook(formData);

            // פתיחת אפליקציית התשלום
            const paymentUrl = 'https://link.payboxapp.com/YxVFpnKu4ZjmG9r16';
            
            if (isMobileDevice()) {
                // במובייל - ניסיון לפתוח את האפליקציה
                window.location.href = paymentUrl;
            } else {
                // בדסקטופ - פתיחה בחלון חדש
                window.open(paymentUrl, '_blank');
            }
        }

        // טעינת הדף
        window.addEventListener('DOMContentLoaded', function() {
            const checkbox = document.getElementById('readConfirmation');
            const proceedBtn = document.getElementById('proceedToPayment');
            const closeModalBtn = document.getElementById('closeModal');
            const modal = document.getElementById('paymentModal');
            const paymentBtn = document.getElementById('paymentLink');
            
            // האזנה לשינוי בצ'קבוקס הראשי
            checkbox.addEventListener('change', toggleProceedButton);
            
            // האזנה לכפתור המשך תשלום
            proceedBtn.addEventListener('click', function() {
                if (!this.disabled) {
                    openPaymentModal();
                }
            });
            
            // האזנה לסגירת המודל
            closeModalBtn.addEventListener('click', closePaymentModal);
            
            // סגירת המודל בלחיצה על הרקע
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    closePaymentModal();
                }
            });
            
            // האזנה לשינויים בטופס עם וולידציה מיידית
            const formInputs = ['firstName', 'lastName', 'phone', 'email', 'group', 'policyCheck', 'termsCheck'];
            formInputs.forEach(inputId => {
                const element = document.getElementById(inputId);
                element.addEventListener('input', function() {
                    validateForm();
                });
                element.addEventListener('change', function() {
                    validateForm();
                });
                element.addEventListener('blur', function() {
                    validateForm();
                });
            });
            
            // האזנה לכפתור התשלום הסופי
            paymentBtn.addEventListener('click', function() {
                if (!this.disabled) {
                    proceedToPayment();
                }
            });
            
            // האזנה לקישור מדיניות ביטולים
            const viewPolicyLink = document.getElementById('viewPolicy');
            viewPolicyLink.addEventListener('click', function(e) {
                e.preventDefault();
                closePaymentModal();
                // גלילה למדיניות ביטולים
                const policySection = document.querySelector('.bg-white\\/80.backdrop-blur-sm.rounded-5xl');
                if (policySection) {
                    policySection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
            
            // האזנה לקישור תקנון
            const viewTermsLink = document.getElementById('viewTerms');
            viewTermsLink.addEventListener('click', function(e) {
                e.preventDefault();
                closePaymentModal();
                // גלילה לתקנון
                const termsSection = document.getElementById('terms-section');
                if (termsSection) {
                    termsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
            
            // הפעלה ראשונית
            toggleProceedButton();
            validateForm();
        });

        // סגירת המודל בלחיצה על ESC
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closePaymentModal();
            }
        });
    </script>
</body>
</html>
